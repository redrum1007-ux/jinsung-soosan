<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ì„í¬íŠ¸ ë„êµ¬ - ì§„ì„±ë„¤ì´ì²˜í‘¸ë“œ</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .import-container {
            max-width: 900px;
            margin: 60px auto;
            padding: 30px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .import-container h2 {
            color: var(--deep-blue);
            margin-bottom: 30px;
            text-align: center;
        }

        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid var(--light-gray);
            border-radius: 10px;
        }

        .form-section h3 {
            color: var(--deep-blue);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--deep-blue);
        }

        .image-preview {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .image-preview img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid var(--light-gray);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--deep-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #004d99;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--mint-green);
            color: var(--deep-blue);
        }

        .btn-secondary:hover {
            background: var(--dark-mint);
            transform: translateY(-2px);
        }

        .help-text {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1 class="logo"><a href="index.html" style="text-decoration:none; color:inherit;">JINSUNG<span>NATURE FOOD</span></a></h1>
            <nav>
                <ul>
                    <li><a href="admin.html">ê´€ë¦¬ì í˜ì´ì§€</a></li>
                    <li><a href="index.html">ì‡¼í•‘ëª°ë¡œ ëŒì•„ê°€ê¸°</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="import-container">
            <h2>ğŸ“¦ ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ìƒí’ˆ ì„í¬íŠ¸</h2>
            
            <div class="success-message" id="successMessage">
                âœ… ìƒí’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!
            </div>

            <div class="form-section">
                <h3>ğŸ”— 1ë‹¨ê³„: ë„¤ì´ë²„ ìƒí’ˆ URL</h3>
                <div class="form-group">
                    <label for="naverUrl">ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ìƒí’ˆ URL</label>
                    <input type="url" id="naverUrl" placeholder="https://smartstore.naver.com/jinsungnaturefood/products/...">
                    <div class="help-text">ë„¤ì´ë²„ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ ìƒí’ˆ URLì„ ì…ë ¥í•˜ê³  ì•„ë˜ ì •ë³´ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”</div>
                </div>
            </div>

            <div class="form-section">
                <h3>ğŸ“ 2ë‹¨ê³„: ìƒí’ˆ ê¸°ë³¸ ì •ë³´</h3>
                <div class="form-group">
                    <label for="productName">ìƒí’ˆëª… *</label>
                    <input type="text" id="productName" required placeholder="ì˜ˆ: í”„ë¦¬ë¯¸ì—„ ì™„ë„ ëŒê¹€ ì„ ë¬¼ì„¸íŠ¸">
                </div>
                <div class="form-group">
                    <label for="productPrice">ê°€ê²© (ì›) *</label>
                    <input type="number" id="productPrice" required placeholder="ì˜ˆ: 35000">
                </div>
                <div class="form-group">
                    <label for="productCategory">ì¹´í…Œê³ ë¦¬ *</label>
                    <select id="productCategory" class="form-control">
                        <option value="ê¹€/ë¯¸ì—­/ë‹¤ì‹œë§ˆ">ê¹€/ë¯¸ì—­/ë‹¤ì‹œë§ˆ</option>
                        <option value="ë©¸ì¹˜">ë©¸ì¹˜</option>
                        <option value="ê±´ì–´ë¬¼">ê±´ì–´ë¬¼</option>
                        <option value="ì„ ë¬¼ì„¸íŠ¸">ì„ ë¬¼ì„¸íŠ¸</option>
                    </select>
                </div>
            </div>

            <div class="form-section">
                <h3>ğŸ–¼ï¸ 3ë‹¨ê³„: ì´ë¯¸ì§€ URL</h3>
                <div class="form-group">
                    <label for="mainImage">ëŒ€í‘œ ì´ë¯¸ì§€ URL *</label>
                    <input type="url" id="mainImage" required placeholder="https://...">
                    <div class="help-text">ë„¤ì´ë²„ ìƒí’ˆì˜ ëŒ€í‘œ ì´ë¯¸ì§€ ìš°í´ë¦­ â†’ ì´ë¯¸ì§€ ì£¼ì†Œ ë³µì‚¬</div>
                </div>
                <div class="form-group">
                    <label for="detailImages">ìƒì„¸ ì´ë¯¸ì§€ URL (ì—¬ëŸ¬ ê°œ ê°€ëŠ¥, ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„)</label>
                    <textarea id="detailImages" placeholder="https://image1.jpg
https://image2.jpg
https://image3.jpg"></textarea>
                </div>
                <div id="imagePreview" class="image-preview"></div>
            </div>

            <div class="form-section">
                <h3>ğŸ“„ 4ë‹¨ê³„: ìƒí’ˆ ì„¤ëª…</h3>
                <div class="form-group">
                    <label for="productDescription">ìƒí’ˆ ì„¤ëª…</label>
                    <textarea id="productDescription" placeholder="ìƒí’ˆì˜ íŠ¹ì§•, ì›ì‚°ì§€, ë³´ê´€ë°©ë²• ë“±ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                <div class="form-group">
                    <label for="productBadge">ë±ƒì§€ (ì„ íƒì‚¬í•­)</label>
                    <input type="text" id="productBadge" placeholder="ì˜ˆ: NEW, ë² ìŠ¤íŠ¸, íˆíŠ¸ìƒí’ˆ">
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="previewProduct()">ë¯¸ë¦¬ë³´ê¸°</button>
                <button class="btn btn-primary" onclick="importProduct()">ìƒí’ˆ ë“±ë¡í•˜ê¸°</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 Jinsung Nature Food. All rights reserved.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ìë™ìœ¼ë¡œ URL ì±„ìš°ê¸°
        const urlParams = new URLSearchParams(window.location.search);
        const naverUrl = urlParams.get('url');
        if (naverUrl) {
            document.getElementById('naverUrl').value = naverUrl;
        }

        // ë¶ë§ˆí´ë¦¿ì—ì„œ ìŠ¤í¬ë©ëœ ë°ì´í„° í™•ì¸
        const scraped = urlParams.get('scraped');
        if (scraped === 'true') {
            const scrapedData = localStorage.getItem('scrapedProduct');
            if (scrapedData) {
                const product = JSON.parse(scrapedData);
                document.getElementById('productName').value = product.name || '';
                document.getElementById('productPrice').value = product.price || '';
                document.getElementById('mainImage').value = product.image || '';
                document.getElementById('productDescription').value = product.description || product.name || '';
                document.getElementById('productBadge').value = product.badge || 'NEW';
                
                // ì„ì‹œ ë°ì´í„° ì‚­ì œ
                localStorage.removeItem('scrapedProduct');
                
                alert('âœ… ìƒí’ˆ ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤!\ní™•ì¸ í›„ "ìƒí’ˆ ë“±ë¡" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.');
            }
        }

        // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
        document.getElementById('mainImage').addEventListener('input', updateImagePreview);
        document.getElementById('detailImages').addEventListener('input', updateImagePreview);

        function updateImagePreview() {
            const mainImage = document.getElementById('mainImage').value.trim();
            const detailImages = document.getElementById('detailImages').value.trim().split('\n').filter(url => url);
            const preview = document.getElementById('imagePreview');

            const allImages = [mainImage, ...detailImages].filter(url => url);
            
            preview.innerHTML = allImages.map(url => 
                `<img src="${url}" alt="ìƒí’ˆ ì´ë¯¸ì§€" onerror="this.src='images/placeholder.jpg'">`
            ).join('');
        }

        function previewProduct() {
            const product = getProductData();
            if (!product) return;

            alert(`ìƒí’ˆ ë¯¸ë¦¬ë³´ê¸°:\n\nìƒí’ˆëª…: ${product.name}\nê°€ê²©: â‚©${new Intl.NumberFormat('ko-KR').format(product.price)}\nì¹´í…Œê³ ë¦¬: ${product.category}\n\nì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°ëŠ” ìœ„ì˜ í”„ë¦¬ë·°ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
        }

        async function importProduct() {
            const product = getProductData();
            if (!product) return;

            // 1. localStorageì— ì €ì¥
            let products = JSON.parse(localStorage.getItem('products')) || [];
            
            // ìƒˆ ID ìƒì„±
            const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
            product.id = newId;

            products.push(product);
            localStorage.setItem('products', JSON.stringify(products));

            // 2. ë°±ì—”ë“œ APIì—ë„ ì €ì¥ (ìˆë‹¤ë©´)
            try {
                const token = localStorage.getItem('token');
                if (token) {
                    await fetch('http://localhost:5000/api/products', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-auth-token': token
                        },
                        body: JSON.stringify(product)
                    });
                }
            } catch (error) {
                console.log('ë°±ì—”ë“œ ì €ì¥ ì‹¤íŒ¨ (ë¡œì»¬ì—ëŠ” ì €ì¥ë¨):', error);
            }

            // ì„±ê³µ ë©”ì‹œì§€
            document.getElementById('successMessage').style.display = 'block';
            setTimeout(() => {
                document.getElementById('successMessage').style.display = 'none';
            }, 3000);

            // í¼ ì´ˆê¸°í™”
            document.getElementById('productName').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('mainImage').value = '';
            document.getElementById('detailImages').value = '';
            document.getElementById('productDescription').value = '';
            document.getElementById('productBadge').value = '';
            document.getElementById('imagePreview').innerHTML = '';

            alert(`ìƒí’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰\n\nìƒí’ˆ ID: ${newId}\nìƒí’ˆëª…: ${product.name}\n\në©”ì¸ í˜ì´ì§€ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
        }

        function getProductData() {
            const name = document.getElementById('productName').value.trim();
            const price = parseInt(document.getElementById('productPrice').value);
            const category = document.getElementById('productCategory').value;
            const mainImage = document.getElementById('mainImage').value.trim();
            const description = document.getElementById('productDescription').value.trim();
            const badge = document.getElementById('productBadge').value.trim();
            const detailImages = document.getElementById('detailImages').value.trim().split('\n').filter(url => url);

            // í•„ìˆ˜ í•„ë“œ ê²€ì¦
            if (!name) {
                alert('ìƒí’ˆëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return null;
            }
            if (!price || price <= 0) {
                alert('ì˜¬ë°”ë¥¸ ê°€ê²©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return null;
            }
            if (!mainImage) {
                alert('ëŒ€í‘œ ì´ë¯¸ì§€ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return null;
            }

            return {
                name,
                price,
                category,
                image: mainImage,
                detailImages: detailImages.length > 0 ? detailImages : [mainImage],
                description: description || name,
                badge: badge || '',
                isNew: badge.toLowerCase().includes('new'),
                isBest: badge.toLowerCase().includes('ë² ìŠ¤íŠ¸') || badge.toLowerCase().includes('best')
            };
        }
    </script>
</body>
</html>
