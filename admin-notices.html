<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µì§€ì‚¬í•­ ê´€ë¦¬ - ê´€ë¦¬ì</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-notices-container {
            max-width: 1200px;
            margin: 60px auto;
            padding: 20px;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .admin-header h2 {
            color: var(--deep-blue);
            font-size: 2rem;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .btn-primary {
            background: var(--deep-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #004d99;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .notice-form {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            display: none;
        }

        .notice-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .notices-table {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: var(--deep-blue);
            color: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
        }

        tbody tr {
            border-bottom: 1px solid var(--light-gray);
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .badge.important {
            background: #ff4444;
            color: white;
        }

        .badge.event {
            background: #ff9800;
            color: white;
        }

        .badge.normal {
            background: var(--mint-green);
            color: var(--deep-blue);
        }

        .action-btn {
            padding: 6px 12px;
            margin: 0 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: #999;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-content h3 {
            color: var(--deep-blue);
            margin-bottom: 25px;
            font-size: 1.8rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1 class="logo"><a href="index.html" style="text-decoration:none; color:inherit;">JINSUNG<span>NATURE FOOD</span></a></h1>
            <nav>
                <ul>
                    <li><a href="admin.html">ê´€ë¦¬ì í™ˆ</a></li>
                    <li><a href="admin-notices.html" class="active">ê³µì§€ì‚¬í•­ ê´€ë¦¬</a></li>
                    <li><a href="notices.html">ê³µì§€ì‚¬í•­ ë³´ê¸°</a></li>
                    <li><a href="index.html">ì‡¼í•‘ëª°</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="admin-notices-container">
            <div class="admin-header">
                <h2>ğŸ“¢ ê³µì§€ì‚¬í•­ ê´€ë¦¬</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="showNoticeForm()">+ ìƒˆ ê³µì§€ ì‘ì„±</button>
                    <button class="btn btn-success" onclick="showPopupForm()" style="background: #ff9800;">ğŸ”” íŒì—… ê³µì§€ ë§Œë“¤ê¸°</button>
                </div>
            </div>

            <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px;">
                <button class="btn" onclick="switchTab('notices')" id="noticesTab" style="background: var(--deep-blue); color: white;">ì¼ë°˜ ê³µì§€</button>
                <button class="btn" onclick="switchTab('popup')" id="popupTab" style="background: #e0e0e0; color: #666;">íŒì—… ê³µì§€</button>
            </div>

            <!-- ì¼ë°˜ ê³µì§€ ì„¹ì…˜ -->
            <div id="noticesSection">

            <div class="notice-form" id="noticeForm">
                <h3 id="formTitle">ìƒˆ ê³µì§€ì‚¬í•­ ì‘ì„±</h3>
                <form onsubmit="saveNotice(event)">
                    <input type="hidden" id="noticeId">
                    
                    <div class="form-group">
                        <label for="noticeCategory">ì¹´í…Œê³ ë¦¬ *</label>
                        <select id="noticeCategory" required>
                            <option value="normal">ì¼ë°˜</option>
                            <option value="important">ì¤‘ìš”</option>
                            <option value="event">ì´ë²¤íŠ¸</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="noticeTitle">ì œëª© *</label>
                        <input type="text" id="noticeTitle" required placeholder="ê³µì§€ì‚¬í•­ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>

                    <div class="form-group">
                        <label for="noticeContent">ë‚´ìš© *</label>
                        <textarea id="noticeContent" required placeholder="ê³µì§€ì‚¬í•­ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="noticeAuthor">ì‘ì„±ì</label>
                        <input type="text" id="noticeAuthor" value="ê´€ë¦¬ì">
                    </div>

                    <div class="form-buttons">
                        <button type="submit" class="btn btn-success">ì €ì¥</button>
                        <button type="button" class="btn btn-secondary" onclick="hideNoticeForm()">ì·¨ì†Œ</button>
                    </div>
                </form>
            </div>

            <div class="notices-table">
                <table>
                    <thead>
                        <tr>
                            <th style="width: 10%;">ì¹´í…Œê³ ë¦¬</th>
                            <th style="width: 40%;">ì œëª©</th>
                            <th style="width: 15%;">ì‘ì„±ì</th>
                            <th style="width: 15%;">ì‘ì„±ì¼</th>
                            <th style="width: 20%;">ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="noticesTableBody"></tbody>
                </table>
            </div>
            </div>

            <!-- íŒì—… ê³µì§€ ì„¹ì…˜ -->
            <div id="popupSection" style="display: none;">
                <div class="notices-table">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 15%;">ìƒíƒœ</th>
                                <th style="width: 40%;">ì œëª©</th>
                                <th style="width: 15%;">ì‹œì‘ì¼</th>
                                <th style="width: 15%;">ì¢…ë£Œì¼</th>
                                <th style="width: 15%;">ê´€ë¦¬</th>
                            </tr>
                        </thead>
                        <tbody id="popupTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- íŒì—… ê³µì§€ ì‘ì„± ëª¨ë‹¬ -->
    <div class="modal" id="popupModal" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <h3>ğŸ”” íŒì—… ê³µì§€ ë§Œë“¤ê¸°</h3>
            <form onsubmit="savePopup(event)">
                <input type="hidden" id="popupId">
                
                <div class="form-group">
                    <label for="popupTitle">íŒì—… ì œëª© *</label>
                    <input type="text" id="popupTitle" required placeholder="ì˜ˆ: ì„¤ ì—°íœ´ ë°°ì†¡ ì•ˆë‚´">
                </div>

                <div class="form-group">
                    <label for="popupContent">íŒì—… ë‚´ìš© *</label>
                    <textarea id="popupContent" required placeholder="íŒì—…ì— í‘œì‹œë  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" style="min-height: 150px;"></textarea>
                </div>

                <div class="form-group">
                    <label for="popupImage">ì´ë¯¸ì§€ URL (ì„ íƒ)</label>
                    <input type="url" id="popupImage" placeholder="https://...">
                    <small style="color: #666; display: block; margin-top: 5px;">íŒì—…ì— í‘œì‹œí•  ì´ë¯¸ì§€ URL (ì„ íƒì‚¬í•­)</small>
                </div>

                <div class="form-group">
                    <label for="popupLink">ë§í¬ URL (ì„ íƒ)</label>
                    <input type="url" id="popupLink" placeholder="https://...">
                    <small style="color: #666; display: block; margin-top: 5px;">í´ë¦­ ì‹œ ì´ë™í•  URL (ì„ íƒì‚¬í•­)</small>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label for="popupStartDate">ì‹œì‘ì¼ *</label>
                        <input type="date" id="popupStartDate" required>
                    </div>
                    <div class="form-group">
                        <label for="popupEndDate">ì¢…ë£Œì¼ *</label>
                        <input type="date" id="popupEndDate" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="popupActive" checked>
                        ì¦‰ì‹œ í™œì„±í™”
                    </label>
                </div>

                <div class="form-buttons">
                    <button type="submit" class="btn btn-success">ì €ì¥</button>
                    <button type="button" class="btn btn-secondary" onclick="closePopupModal()">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2026 Jinsung Nature Food. All rights reserved.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        let editingNoticeId = null;

        function loadNotices() {
            const notices = JSON.parse(localStorage.getItem('notices')) || [];
            displayNotices(notices);
        }

        function displayNotices(notices) {
            const tbody = document.getElementById('noticesTableBody');
            
            if (notices.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="empty-state">
                            <div>ğŸ“­</div>
                            <p>ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        </td>
                    </tr>
                `;
                return;
            }

            // ìµœì‹ ìˆœ ì •ë ¬
            notices.sort((a, b) => new Date(b.date) - new Date(a.date));

            tbody.innerHTML = notices.map(notice => `
                <tr>
                    <td>
                        <span class="badge ${notice.category}">
                            ${getCategoryName(notice.category)}
                        </span>
                    </td>
                    <td><strong>${notice.title}</strong></td>
                    <td>${notice.author}</td>
                    <td>${formatDate(notice.date)}</td>
                    <td>
                        <button class="action-btn btn-primary" onclick="editNotice(${notice.id})">ìˆ˜ì •</button>
                        <button class="action-btn btn-danger" onclick="deleteNotice(${notice.id})">ì‚­ì œ</button>
                    </td>
                </tr>
            `).join('');
        }

        function showNoticeForm() {
            document.getElementById('formTitle').textContent = 'ìƒˆ ê³µì§€ì‚¬í•­ ì‘ì„±';
            document.getElementById('noticeForm').classList.add('active');
            clearForm();
            editingNoticeId = null;
        }

        function hideNoticeForm() {
            document.getElementById('noticeForm').classList.remove('active');
            clearForm();
            editingNoticeId = null;
        }

        function clearForm() {
            document.getElementById('noticeId').value = '';
            document.getElementById('noticeCategory').value = 'normal';
            document.getElementById('noticeTitle').value = '';
            document.getElementById('noticeContent').value = '';
            document.getElementById('noticeAuthor').value = 'ê´€ë¦¬ì';
        }

        function saveNotice(event) {
            event.preventDefault();

            const notices = JSON.parse(localStorage.getItem('notices')) || [];
            const category = document.getElementById('noticeCategory').value;
            const title = document.getElementById('noticeTitle').value;
            const content = document.getElementById('noticeContent').value;
            const author = document.getElementById('noticeAuthor').value;

            if (editingNoticeId) {
                // ìˆ˜ì •
                const index = notices.findIndex(n => n.id === editingNoticeId);
                if (index !== -1) {
                    notices[index] = {
                        ...notices[index],
                        category,
                        title,
                        content,
                        author,
                        updatedDate: new Date().toISOString().split('T')[0]
                    };
                }
                alert('ê³µì§€ì‚¬í•­ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                // ìƒˆë¡œ ì‘ì„±
                const newNotice = {
                    id: notices.length > 0 ? Math.max(...notices.map(n => n.id)) + 1 : 1,
                    category,
                    title,
                    content,
                    author,
                    date: new Date().toISOString().split('T')[0]
                };
                notices.push(newNotice);
                alert('ê³µì§€ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            localStorage.setItem('notices', JSON.stringify(notices));
            hideNoticeForm();
            loadNotices();
        }

        function editNotice(id) {
            const notices = JSON.parse(localStorage.getItem('notices')) || [];
            const notice = notices.find(n => n.id === id);
            
            if (notice) {
                document.getElementById('formTitle').textContent = 'ê³µì§€ì‚¬í•­ ìˆ˜ì •';
                document.getElementById('noticeCategory').value = notice.category;
                document.getElementById('noticeTitle').value = notice.title;
                document.getElementById('noticeContent').value = notice.content;
                document.getElementById('noticeAuthor').value = notice.author;
                
                editingNoticeId = id;
                document.getElementById('noticeForm').classList.add('active');
            }
        }

        function deleteNotice(id) {
            if (!confirm('ì •ë§ë¡œ ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            let notices = JSON.parse(localStorage.getItem('notices')) || [];
            notices = notices.filter(n => n.id !== id);
            localStorage.setItem('notices', JSON.stringify(notices));
            
            alert('ê³µì§€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            loadNotices();
        }

        function getCategoryName(category) {
            const names = {
                'important': 'ì¤‘ìš”',
                'event': 'ì´ë²¤íŠ¸',
                'normal': 'ì¼ë°˜'
            };
            return names[category] || 'ì¼ë°˜';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}.${month}.${day}`;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', loadNotices);

        // ===== íŒì—… ê´€ë¦¬ ê¸°ëŠ¥ =====
        let editingPopupId = null;

        function switchTab(tab) {
            const noticesTab = document.getElementById('noticesTab');
            const popupTab = document.getElementById('popupTab');
            const noticesSection = document.getElementById('noticesSection');
            const popupSection = document.getElementById('popupSection');

            if (tab === 'notices') {
                noticesTab.style.background = 'var(--deep-blue)';
                noticesTab.style.color = 'white';
                popupTab.style.background = '#e0e0e0';
                popupTab.style.color = '#666';
                noticesSection.style.display = 'block';
                popupSection.style.display = 'none';
            } else {
                popupTab.style.background = 'var(--deep-blue)';
                popupTab.style.color = 'white';
                noticesTab.style.background = '#e0e0e0';
                noticesTab.style.color = '#666';
                noticesSection.style.display = 'none';
                popupSection.style.display = 'block';
                loadPopups();
            }
        }

        function loadPopups() {
            const popups = JSON.parse(localStorage.getItem('popups')) || [];
            displayPopups(popups);
        }

        function displayPopups(popups) {
            const tbody = document.getElementById('popupTableBody');
            
            if (popups.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" class="empty-state">
                            <div>ğŸ“­</div>
                            <p>ë“±ë¡ëœ íŒì—… ê³µì§€ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        </td>
                    </tr>
                `;
                return;
            }

            // ìµœì‹ ìˆœ ì •ë ¬
            popups.sort((a, b) => new Date(b.startDate) - new Date(a.startDate));

            tbody.innerHTML = popups.map(popup => {
                const today = new Date().toISOString().split('T')[0];
                const isActive = popup.active && popup.startDate <= today && popup.endDate >= today;
                
                return `
                    <tr>
                        <td>
                            <span class="badge ${isActive ? 'important' : 'normal'}">
                                ${isActive ? 'í™œì„±' : 'ë¹„í™œì„±'}
                            </span>
                        </td>
                        <td><strong>${popup.title}</strong></td>
                        <td>${formatDate(popup.startDate)}</td>
                        <td>${formatDate(popup.endDate)}</td>
                        <td>
                            <button class="action-btn btn-primary" onclick="editPopup(${popup.id})">ìˆ˜ì •</button>
                            <button class="action-btn btn-danger" onclick="deletePopup(${popup.id})">ì‚­ì œ</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function showPopupForm() {
            document.getElementById('popupModal').style.display = 'flex';
            clearPopupForm();
            editingPopupId = null;
            
            // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('popupStartDate').value = today;
            
            // 7ì¼ í›„ë¥¼ ì¢…ë£Œì¼ ê¸°ë³¸ê°’ìœ¼ë¡œ
            const weekLater = new Date();
            weekLater.setDate(weekLater.getDate() + 7);
            document.getElementById('popupEndDate').value = weekLater.toISOString().split('T')[0];
        }

        function closePopupModal() {
            document.getElementById('popupModal').style.display = 'none';
            clearPopupForm();
            editingPopupId = null;
        }

        function clearPopupForm() {
            document.getElementById('popupId').value = '';
            document.getElementById('popupTitle').value = '';
            document.getElementById('popupContent').value = '';
            document.getElementById('popupImage').value = '';
            document.getElementById('popupLink').value = '';
            document.getElementById('popupStartDate').value = '';
            document.getElementById('popupEndDate').value = '';
            document.getElementById('popupActive').checked = true;
        }

        function savePopup(event) {
            event.preventDefault();

            const popups = JSON.parse(localStorage.getItem('popups')) || [];
            const title = document.getElementById('popupTitle').value;
            const content = document.getElementById('popupContent').value;
            const image = document.getElementById('popupImage').value;
            const link = document.getElementById('popupLink').value;
            const startDate = document.getElementById('popupStartDate').value;
            const endDate = document.getElementById('popupEndDate').value;
            const active = document.getElementById('popupActive').checked;

            if (new Date(startDate) > new Date(endDate)) {
                alert('ì¢…ë£Œì¼ì€ ì‹œì‘ì¼ë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            if (editingPopupId) {
                // ìˆ˜ì •
                const index = popups.findIndex(p => p.id === editingPopupId);
                if (index !== -1) {
                    popups[index] = {
                        ...popups[index],
                        title,
                        content,
                        image,
                        link,
                        startDate,
                        endDate,
                        active,
                        updatedDate: new Date().toISOString().split('T')[0]
                    };
                }
                alert('íŒì—… ê³µì§€ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                // ìƒˆë¡œ ì‘ì„±
                const newPopup = {
                    id: popups.length > 0 ? Math.max(...popups.map(p => p.id)) + 1 : 1,
                    title,
                    content,
                    image,
                    link,
                    startDate,
                    endDate,
                    active,
                    createdDate: new Date().toISOString().split('T')[0]
                };
                popups.push(newPopup);
                alert('íŒì—… ê³µì§€ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }

            localStorage.setItem('popups', JSON.stringify(popups));
            closePopupModal();
            loadPopups();
        }

        function editPopup(id) {
            const popups = JSON.parse(localStorage.getItem('popups')) || [];
            const popup = popups.find(p => p.id === id);
            
            if (popup) {
                document.getElementById('popupTitle').value = popup.title;
                document.getElementById('popupContent').value = popup.content;
                document.getElementById('popupImage').value = popup.image || '';
                document.getElementById('popupLink').value = popup.link || '';
                document.getElementById('popupStartDate').value = popup.startDate;
                document.getElementById('popupEndDate').value = popup.endDate;
                document.getElementById('popupActive').checked = popup.active;
                
                editingPopupId = id;
                document.getElementById('popupModal').style.display = 'flex';
            }
        }

        function deletePopup(id) {
            if (!confirm('ì •ë§ë¡œ ì´ íŒì—… ê³µì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            let popups = JSON.parse(localStorage.getItem('popups')) || [];
            popups = popups.filter(p => p.id !== id);
            localStorage.setItem('popups', JSON.stringify(popups));
            
            alert('íŒì—… ê³µì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            loadPopups();
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.addEventListener('click', function(e) {
            const popupModal = document.getElementById('popupModal');
            if (e.target === popupModal) {
                closePopupModal();
            }
        });
    </script>
</body>
</html>
